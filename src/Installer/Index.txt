<?php

/**
 * Load the Composer Autoloader
 */

include 'vendor/autoload.php';

/**
 * This is where you can change the environment
 * of your application. You can choose from "development" and
 * "production".
 *
 * According to Patrick Louys, never show any errors in your
 * production environment. A stack trace or even just a
 * simple error message can help someone to gain access to
 * your system. Always show a user friendly error page
 * instead and send an email to yourself, write to a log or
 * something similar. So only you can see the errors in the
 * production environment.
 *
 * References:
 * https://github.com/filp/whoops
 * https://github.com/PatrickLouys/no-framework-tutorial/blob/master/03-error-handler.md
 */

error_reporting(E_ALL);

$environment = 'development';

/**
* Register the error handler
*/

$whoops = new \Whoops\Run;

if ($environment !== 'production') {
	$whoops->pushHandler(new \Whoops\Handler\PrettyPageHandler);
} else {
	$whoops->pushHandler(function ($error) {
		echo \Slytherin\View::render('404');
	});
}

$whoops->register();

/**
 * Import the Slytherin namespace
 */

use Slytherin\Application;
use Slytherin\Config;

/**
 * Load Pux's Mux (https://github.com/c9s/Pux)
 */

$route = new \Pux\Mux();

/**
 * Initialize and Run Slytherin
 */

$app = new Application($route);
$app->run();